{% extends 'base.html' %}
{% load static %}
{% block title %}Cadastrar Associado(a){% endblock title %}
{% block create_associado %}
<!-- Navbar (já configurada, incluímos no topo) -->
{% include 'components/navbar_associacao.html' %}

<div class="container mx-auto mt-8 bg-gray-100" style="max-width: 980px;">
    <h1 class="text-2xl font-bold mb-4 text-center py-2">Cadastrar Associado</h1>
    <form method="post" enctype="multipart/form-data" class="bg-white p-6 rounded shadow-md">
        {% csrf_token %}
        {{ form.errors }}
        <!-- Informações Pessoais -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Exibir o nome do usuário selecionado -->
            <h2 class="text-xl text-gray-400 font-bold mb-4">{{ user.get_full_name|default:user.username }}</h2>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Usuário selecionado: Username | Nome | Email Pessoal</label>
                <div class="bg-gray-100 p-2 rounded-md">
                    <span class="text-gray-500">{{user.username}} </span> 
                    | <span class="text-green-500">{{ user.get_full_name|default:user.username }}</span>
                    | <span class="text-blue-500">{{ user.email }}</span>
                </div>
            </div>
        </div>

        <!-- Vinculos do Associado -->
        <h2 class="text-lg font-bold mb-4  py-4">Vículos do Associado</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Unidade ASSOCIAÇÂO -->
            <div>
                <label for="id_associacao" class="block text-sm font-medium text-gray-700 mb-1">Associação</label>
                <select
                    name="associacao"
                    id="id_associacao"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                <option value="" {% if not form.associacao.value %}selected{% endif %}>Selecione a Associação</option>
                {% for choice in form.associacao.field.queryset %}
                    <option value="{{ choice.id }}" {% if choice.id == form.associacao.value %}selected{% endif %}>
                        {{ choice.nome_fantasia }}
                    </option>
                {% endfor %}
                </select>
                {% for error in form.associacao.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- Repartição -->
            <div>
                <label for="id_reparticao" class="block text-sm font-medium text-gray-700 mb-1">Repartição</label>
                <select
                    name="{{ form.reparticao.name }}" 
                    id="{{ form.reparticao.id_for_label }}"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    value="{{ form.reparticao.value|default:'' }}"
                >
                <option value="" {% if not form.reparticao.value %}selected{% endif %}>Selecione a Repartição</option>
                {% for choice in form.reparticao.field.queryset %}
                    <option value="{{ choice.id }}" {% if choice.id == form.reparticao.value %}selected{% endif %}>
                        {{ choice.nome_reparticao }}
                    </option>
                {% endfor %}
            </select>
                {% for error in form.reparticao.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- Município de Circunscrição  -->
            <div>
                <label for="id_municipio_circunscricao" class="block text-sm font-medium text-gray-700 mb-1">Município de Circusncrição /Atuação</label>
                <select 
                name="{{ form.municipio_circunscricao.name }}" 
                id="{{ form.municipio_circunscricao.id_for_label }}"
                class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                <option value="" {% if not form.municipio_circunscricao.value %}selected{% endif %}>Selecione o Município</option>
                {% for choice in form.municipio_circunscricao.field.queryset %}
                    <option value="{{ choice.id }}" {% if choice.id == form.municipio_circunscricao.value %}selected{% endif %}>
                        {{ choice.municipio }}
                    </option>
                {% endfor %}
            </select>
                {% for error in form.municipio_circunscricao.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- Campo Data Da Filiação -->
            <div>
                <label for="id_data_filiacao" class="block text-sm font-medium text-gray-700 mb-1">Data da Filiação</label>
                <input
                    type="date"
                    name="{{ form.data_filiacao.name }}"
                    id="id_data_filiacao"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    value="{{ form.data_filiacao.value|default:'' }}"
                >
                {% for error in form.data_filiacao.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>                                                                              
        </div>
        <br><hr>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <!-- Celular -->
            <div>
                <label for="id_celular" class="block text-sm font-medium text-gray-700 mb-1">Celular</label>
                <input
                    type="text"
                    name="{{ form.celular.name }}"
                    id="id_celular"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="(48)99999-9999"
                    value="{{ form.celular.value|default:'' }}"
                    oninput="mascaraTelefone(this)"
                >
                {% for error in form.celular.errors %}
                <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- Celular Correspondência -->
            <div>
                <label for="id_celular_correspondencia" class="block text-sm font-medium text-gray-700 mb-1">Celular Correspondências</label>
                <input
                    type="text"
                    name="{{ form.celular_correspondencia.name }}"
                    id="id_celular_correspondencia"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="(48)99999-9999"
                    value="{{ form.celular_correspondencia.value|default:'' }}"
                    oninput="mascaraTelefone(this)"
                >
                {% for error in form.celular_correspondencia.errors %}
                <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>            

            <!-- CPF -->
            <div>
                <label for="id_cpf" class="block text-sm font-medium text-gray-700 mb-1">CPF</label>
                <input
                    type="text"
                    name="{{ form.cpf.name }}"
                    id="id_cpf"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="000.000.000-00"
                    value="{{ form.cpf.value|default:'' }}"
                    oninput="mascaraCPF(this)"
                >
                {% for error in form.cpf.errors %}
                <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- Senha Gov -->
            <div>
                <label for="id_senha_gov" class="block text-sm font-medium text-gray-700 mb-1">Senha Gov</label>
                <input
                    type="text"
                    name="{{ form.senha_gov.name }}"
                    id="id_senha_gov"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Senha Gov"
                    value="{{ form.senha_gov.value|default:'' }}"
                >
                {% for error in form.senha_gov.errors %}
                <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <!-- E-mail -->
            <div>
                <label for="id_email" class="block text-sm font-medium text-gray-700 mb-1">E-mail</label>
                <input
                    type="email"
                    name="{{ form.email.name }}"
                    id="id_email"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-blue-300 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    value="{{ form.initial.email|default:form.email.value|default:'' }}"
                    readonly
                >
                {% for error in form.email.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>            
            <!-- Senha Google -->
            <div>
                <label for="id_senha_google" class="block text-sm font-medium text-gray-700 mb-1">Senha Google</label>
                <input
                    type="text"
                    name="{{ form.senha_google.name }}"
                    id="id_senha_google"
                    class="appearance-none border border-gray-300 rounded-md w-full py-2 px-3 text-gray-500 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Senha Google"
                    value="{{ form.senha_google.value|default:'' }}"
                >
                {% for error in form.senha_google.errors %}
                <p class="text-red-500 text-xs mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            <button
                type="submit"
                name="save_and_continue"
                value="1"
                class="bg-blue-400 hover:bg-green-500 text-white font-medium text-xl py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-300 shadow-sm transition-all duration-200">
                Salvar e continuar
            </button>
        </div>
        <br><hr>

        {% if form.non_field_errors %}
        <div class="text-red-500 text-xs mt-1">
            {% for error in form.non_field_errors %}
                <p class="text-red-500">{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}
    
    </form>
    {% if messages %}
        <div class="alert alert-success">
            {% for message in messages %}
                <p class="text-green-500">{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}
    {% if form.non_field_errors %}
        <div class="text-red-500 text-xs mt-1">
            {% for error in form.non_field_errors %}
                <p class="text-red-500">{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}    
</div>
<!-- Footer -->
{% include "components/footer_associacao.html" %}



<script src="{% static 'js/mascaraTelefone.js' %}"></script>
<script src="{% static 'js/mascaraCPF.js' %}"></script>
<script src="{% static 'js/formularioEventos.js' %}"></script>

{% endblock create_associado %}
